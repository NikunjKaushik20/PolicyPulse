services:
  - type: web
    name: policypulse
    env: python
    runtime: python-3.11
    buildCommand: "pip install -r requirements.txt && python cli.py ingest-all"
    startCommand: "uvicorn src.api:app --host 0.0.0.0 --port $PORT"
    healthCheckPath: /health
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: CHROMADB_DIR
        value: /opt/render/project/src/chromadb_data
      - key: GEMINI_API_KEY
        sync: false  # User needs to add via Render dashboard
      - key: GOOGLE_CLOUD_TRANSLATE_KEY
        sync: false
      - key: TWILIO_ACCOUNT_SID
        sync: false
      - key: TWILIO_AUTH_TOKEN
        sync: false
      - key: TWILIO_PHONE_NUMBER
         sync: false
    disk:
      name: chromadb-storage
      mountPath: /opt/render/project/src/chromadb_data
      sizeGB: 1
